{{ define "title" }}My Goals Dashboard{{ end }}
{{ define "description" }}
  View your goal timeline, track progress, and manage your objectives. Access
  your complete roadmap and achievements in one place.
{{ end }}
{{ define "main" }}
  <div class="mb-4">
    <hgroup class="text-center">
      <h1 class="text-lg font-bold text-base-content/50">
        {{ if .Data.Branding.Title }}{{ .Data.Branding.Title }}{{ end }}
      </h1>
      <p class="text-sm text-base-content/30">
        {{ if .Data.Branding.Description }}
          {{ .Data.Branding.Description }}
        {{ end }}
      </p>
    </hgroup>
  </div>
  {{ if .Data.Goals }}
    <ul class="timeline timeline-vertical">
      {{ range $groupIndex, $group := .Data.GoalGroups }}
        {{ $allAchieved := true }}
        {{ range $goal := $group.Goals }}
          {{ if not $goal.Achieved }}
            {{ $allAchieved = false }}
          {{ end }}
        {{ end }}
        <li>
          {{ if ne $groupIndex 0 }}
            <hr class="{{ if $allAchieved }}bg-success{{ end }}" />
          {{ end }}

          {{ if eq (mod $groupIndex 2) 0 }}
            <!-- Group on left side (timeline-start) -->
            <div class="timeline-start space-y-2">
              <div class="text-xs text-base-content/50">{{ $group.Date.Format "January 2, 2006" }}</div>
              {{ range $goalIndex, $goal := $group.Goals }}
                <a
                  href="/goals/{{ $goal.ID }}"
                  preload="mouseover"
                  class="block timeline-box bg-base-200 border-l
                    {{ if $goal.Achieved }}border-success{{ else }}border-primary{{ end }}
                    {{ if $goal.VisibleToPublic }}{{else}}border-dashed{{ end }}
                    {{ if gt $goal.TotalCriteriaCount 0 }}tooltip{{ end }}
                    {{if eq $goal.TotalCriteriaCount $goal.CompletedCriteriaCount }}tooltip-primary{{end}}"
                  {{ if gt $goal.TotalCriteriaCount 0 }}
                    data-tip="{{ $goal.CompletedCriteriaCount }} of {{ $goal.TotalCriteriaCount }} success criteria achieved"
                  {{ end }}
                >
                  <div class="font-bold">{{ $goal.Goal }}</div>
                </a>
              {{ end }}
            </div>
            <div class="timeline-middle">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="h-5 w-5 {{ if $allAchieved }}text-success{{ end }}"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z"
                  clip-rule="evenodd"
                />
              </svg>
            </div>
            {{ if ne $groupIndex (sub (len $.Data.GoalGroups) 1) }}
              <hr class="{{ if $allAchieved }}bg-success{{ end }}" />
            {{ end }}
          {{ else }}
            <!-- Group on right side (timeline-end) -->
            <div class="timeline-middle">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="h-5 w-5 {{ if $allAchieved }}text-success{{ end }}"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z"
                  clip-rule="evenodd"
                />
              </svg>
            </div>
            <div class="timeline-end space-y-2">
              <div class="text-xs text-base-content/50">{{ $group.Date.Format "January 2, 2006" }}</div>
              {{ range $goalIndex, $goal := $group.Goals }}
                <a
                  href="/goals/{{ $goal.ID }}"
                  preload="mouseover"
                  class="block timeline-box bg-base-200 border-l
                    {{ if $goal.Achieved }}border-success{{ else }}border-primary{{ end }}
                    {{ if $goal.VisibleToPublic }}{{else}}border-dashed{{ end }}
                    {{ if gt $goal.TotalCriteriaCount 0 }}tooltip{{ end }}
                    {{if eq $goal.TotalCriteriaCount $goal.CompletedCriteriaCount }}tooltip-primary{{end}}"
                  {{ if gt $goal.TotalCriteriaCount 0 }}
                    data-tip="{{ $goal.CompletedCriteriaCount }} of {{ $goal.TotalCriteriaCount }} success criteria achieved"
                  {{ end }}
                >
                  <div class="font-bold">{{ $goal.Goal }}</div>
                </a>
              {{ end }}
            </div>
            {{ if ne $groupIndex (sub (len $.Data.GoalGroups) 1) }}
              <hr class="{{ if $allAchieved }}bg-success{{ end }}" />
            {{ end }}
          {{ end }}
        </li>
      {{ end }}
      <li>
        <hr />
        <div class="timeline-middle">
          {{ $lastGoal := index .Data.Goals (sub (len .Data.Goals) 1) }}
          <a
            href="/goals/add/?default_due={{ index .Data.GoalDefaultDues $lastGoal.ID }}"
            preload="mouseover"
            class="tooltip tooltip-bottom btn btn-circle btn-ghost w-8 h-8 opacity-50"
            data-tip="Add Goal"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M5 12h14" />
              <path d="M12 5v14" />
            </svg>
          </a>
        </div>
      </li>
    </ul>
  {{ else }}
    <div>
      <a href="/goals/add/" preload="mouseover" class="btn btn-primary">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-plus-icon lucide-plus"
        >
          <path d="M5 12h14" />
          <path d="M12 5v14" />
        </svg>
        First Goal
      </a>
      <a href="/settings#branding" preload="mouseover" class="btn">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-signature-icon lucide-signature"
        >
          <path
            d="m21 17-2.156-1.868A.5.5 0 0 0 18 15.5v.5a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1c0-2.545-3.991-3.97-8.5-4a1 1 0 0 0 0 5c4.153 0 4.745-11.295 5.708-13.5a2.5 2.5 0 1 1 3.31 3.284"
          />
          <path d="M3 21h18" />
        </svg>
        Configure Branding</a
      >
    </div>
  {{ end }}
{{ end }}
