{{ define "title" }}Edit Goal{{ end }}
{{ define "description" }}
  Modify your goal details, update deadlines, mark achievements, and adjust
  visibility settings for your timeline.
{{ end }}
{{ define "main" }}
  <div class="flex flex-col gap-2">
    <a href="/goals" class="text-base-content/50 hover:text-base-content"
      >&larr; Back</a
    >
    <form action="/goals/{{ .Form.ID }}" method="post">
      <fieldset
        class="fieldset bg-base-200 border-base-300 rounded-box w-xs border p-4"
      >
        <legend class="fieldset-legend">Goal</legend>

        <label for="goal" class="label">Goal</label>
        <input
          id="goal"
          name="goal"
          value="{{ .Form.Goal }}"
          type="text"
          class="input"
          placeholder="My goal"
        />
        {{ with .Form.Errors.goal }}
          <label class="label">
            <span class="label-text-alt text-error">{{ . }}</span>
          </label>
        {{ end }}


        <label for="due" class="label">Due</label>
        <input
          id="due"
          name="due"
          type="date"
          class="input"
          value="{{ .Form.Due }}"
        />
        {{ with .Form.Errors.due }}
          <label class="label">
            <span class="label-text-alt text-error">{{ . }}</span>
          </label>
        {{ end }}


        <label for="achieved" class="label">
          <input
            id="achieved"
            type="checkbox"
            name="achieved"
            class="checkbox"
            {{ if
              .Form.Achieved
            }}
              checked
            {{ end }}
          />
          Achieved
        </label>
        {{ with .Form.Errors.achieved }}
          <label class="label">
            <span class="label-text-alt text-error">{{ . }}</span>
          </label>
        {{ end }}


        <label for="visible" class="label">
          <input
            id="visible"
            type="checkbox"
            name="visible"
            class="checkbox"
            {{ if
              .Form.VisibleToPublic
            }}
              checked
            {{ end }}
          />
          Visible to the public after shared
        </label>
        {{ with .Form.Errors.visible }}
          <label class="label">
            <span class="label-text-alt text-error">{{ . }}</span>
          </label>
        {{ end }}

        <div class="grid grid-cols-4 gap-1 mt-4">
          <button class="btn btn-neutral col-span-3">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-check-icon lucide-check"
            >
              <path d="M20 6 9 17l-5-5" />
            </svg>
            Save
          </button>
          <button type="button" class="btn" hx-delete="/goals/{{ .Form.ID }}">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-trash-icon lucide-trash"
            >
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
              <path d="M3 6h18" />
              <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
            </svg>
          </button>
        </div>
      </fieldset>
    </form>

    <fieldset
      class="fieldset bg-base-200 border-base-300 rounded-box w-xs border p-4 mt-4"
    >
      <legend class="fieldset-legend">Success Criteria</legend>

      {{ if .Data.SuccessCriteria }}
        <ul class="space-y-2 mb-3">
          {{ range .Data.SuccessCriteria }}
            <li class="flex gap-2 items-center">
              <form
                action="/goals/{{ $.Data.GoalID }}/criteria/{{ .ID }}/toggle"
                method="post"
                class="contents"
              >
                <input
                  type="checkbox"
                  class="checkbox checkbox-sm"
                  {{ if .Completed }}checked{{ end }}
                  onchange="this.form.submit()"
                />
              </form>
              <span
                class="{{ if .Completed }}line-through text-base-content/50{{ end }} flex-1"
              >
                {{ .Description }}
              </span>
              <form
                action="/goals/{{ $.Data.GoalID }}/criteria/{{ .ID }}"
                method="post"
                class="contents"
              >
                <input type="hidden" name="_method" value="DELETE" />
                <button
                  type="submit"
                  class="btn btn-ghost btn-xs"
                  onclick="return confirm('Delete this item?')"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M18 6 6 18M6 6l12 12" />
                  </svg>
                </button>
              </form>
            </li>
          {{ end }}
        </ul>
      {{ end }}

      <form
        action="/goals/{{ .Data.GoalID }}/criteria"
        method="post"
        class="flex gap-2"
      >
        <input
          type="text"
          name="description"
          placeholder="Add a success criterion..."
          class="input input-sm flex-1"
        />
        <button type="submit" class="btn btn-sm">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M5 12h14M12 5v14" />
          </svg>
          Add
        </button>
      </form>
    </fieldset>
  </div>

  {{ with .Flash }}
    <div hx-ext="remove-me">
      <div
        role="alert"
        remove-me="3s"
        class="absolute bottom-2 md:right-2 right-6 alert alert-success"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 shrink-0 stroke-current"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
        <span>{{ .Content }}</span>
      </div>
    </div>
  {{ end }}
{{ end }}
